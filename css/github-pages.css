---
title:"GitHub Pagesのトラブルシューティング"
date:"2018-05-09"
category:"blog"
---
image200:https://cdn-ak.f.st-hatena.com/images/fotolife/a/araemonz/20180729/20180729125958.jpg
GitHub Pagesでサイトを運用する際につまづいた事を忘備録として残しておきます。
Octocatロゴは https://github.com/logos から利用させてもらっています。


## サイトが反映されない
サイトが何時間もたってもビルドできていないと思ったら、こんなメールが届いていた。
```
The page build failed for the `master` branch with the following error:

The symbolic link `/works` targets a file which does not exist within your site's repository. For more information, see https://help.github.com/articles/page-build-failed-symlink-does-not-exist-within-your-site-s-repository/.

For information on troubleshooting Jekyll see:

  https://help.github.com/articles/troubleshooting-jekyll-builds

If you have any questions you can contact us by replying to this email.
```

要はシンボリックリンクがサイト内に含まれていてビルドエラーになっているよという事だった。<b>シンボリックリンクを見つけて削除</b>したら一瞬でビルドできた。


## DNS設定に関するwarning
```
The page build completed successfully, but returned the following warning for the `master` branch:

Your site's DNS settings are using a custom subdomain, works.kamityping.com, that's set up as an A record. We recommend you change this to a CNAME record pointing at araemon.github.io. For more information, see https://help.github.com/articles/using-a-custom-domain-with-github-pages/.

For information on troubleshooting Jekyll see:

  https://help.github.com/articles/troubleshooting-jekyll-builds

If you have any questions you can contact us by replying to this email.
```

DNSのAレコードにサブドメインを割り当てないでくれとのことの様だ。
サブドメインはCNAMEで登録してくれと。
DNSの事がよくわかっていないのだが、なんとか解決できた。

digコマンドで確認してみる

`dig works.kamityping.com`

image:https://cdn-ak.f.st-hatena.com/images/fotolife/a/araemonz/20180729/20180729130030.jpg

サブドメイン(works.kamityping.com)を直接GithubのサーバーIPアドレスに割り当てていた。これがいけないらしい。
次の様にDNSの設定を変えたら今のところワーニングのメールが来なくなったので、うまくできたのかな？

image300:https://cdn-ak.f.st-hatena.com/images/fotolife/a/araemonz/20180729/20180729130045.jpg

image:https://cdn-ak.f.st-hatena.com/images/fotolife/a/araemonz/20180729/20180729130101.jpg


こんな感じで名前解決されているということか

`works.kamityping.com.`
　↓
`araemon.github.io.`
　↓
`sni.github.map.fastly.net.`
　↓
`185.199.108.153`
`185.199.109.153`
`185.199.110.153`
`185.199.111.153`

追記:
GitHub Pagesにはユーザーサイトとプロジェクトサイトがある様で、プロジェクトサイトで動かしていたようだ。cname割り当てれば問題ないのだけど、なんだか構造がわかりづらい。
また、ルートドメインをユーザーサイトに割り当てるにはムームードメインのDNSでは一筋縄にはいかないようで、GitHubにしたらシンプルかなと思ったがそうでもないことがわかった。月に10万リクエストの制限もあるしWebでサービスを提供するなら素直にレンタルサーバー使った方が効率良さそうだ。
ということで元のさくらサーバーに引っ越すことに。静的HTMLだからコピペすれば良いだけなので引っ越し作業は一瞬だ。
今回はGitHub Pagesを試したことでGitの構造が理解できて良い勉強になったということで。