<!DOCTYPE html>
<html lang="ja">

<head>
        <meta charset="UTF-8">
<title>Pythonのトレンド動向とクラスの書き方</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" type="text/css" href="/css/main.css" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-icon-144x144.jpg">
<link rel="shortcut icon" href="/images/favicon.ico">
<meta content="Pythonのトレンド動向とクラスの書き方" property="og:title" />
<meta content="article" property="og:type" />
<meta content="https://araemon.github.io/blog/.html" property="og:url" />
<meta content="https://araemon.github.io/images/trend-python.jpg" property="og:image" />
<?php echo $SITE['article_appid']; ?>
<link rel="stylesheet" type="text/css" href="/css/icon.css" />
</head>

<body>

        <div id="container">
                <div id="header" class="blog">
                        <div class="layerTransparent">
                                <div class="container">
                                        <ul class="nav">
<li><a href="/blog/">Blog</a></li>
<li><a href="/kamityping/">KamiTyping</a></li>
<li><a href="/chazuke/">Chazuke</a></li>
<li><a href="/harmonize/">Harmonize</a></li>
<li><a href="/apps/">Other Apps</a></li>
<li><a href="/oss/">OSS</a></li>
<li><a href="/about/">About</a></li>
</ul>
<div class="copyright">Copyright © Toshihiko Arai</div>

                                </div>
                        </div>
                </div>

                <div id="contents">
                        <article>
                                <div class="tag">
                                        <a href="/blog/" class="tagHighlight">blog</a>
                                </div>
                                <h1>Pythonのトレンド動向とクラスの書き方</h1>
                                <div class="time"><time pubdate="" datetime="2018-12-18">2018-12-18</time></div>
                                <p>
                                        <?php echo $SITE['article_toc']; ?>

                                        <h2>はじめに</h2>
AIや機械学習、ディープラーニングなどのブームでPythonが人気上昇していることは知っていました。ここ数年で、本屋でもずらりとPythonの書籍が増えよく目に入っていました。しかし、自分には必要ないかなと思っていて遠ざけていましたが、遊びがてらPythonに触れてみたところ、書きやすく読みやすいことがわかり好感をもちました。他人が書いたプログラムを読むときも、インデントというルールが理解を助けてくれるようで、読みやすく感じます。そして文字列の扱いがとても便利にできているので、何も科学技術計算のためだけに使うというような言語でもなさそうです。その場しのぎでPHPを使ってきましたが、この機会にPythonに乗り換えても良さそうです。<br>
ここでは、Pythonの導入としてクラスの書き方を調べることにしました。<br>
<br>
<h2>各言語のトレンド動向</h2>
ところでPythonも含め、主要なプログラミング言語がどのような動向にあるのか「Google Trends」で調べてみました。<br>
<a href="https://trends.google.co.jp/trends/?geo=JP">https://trends.google.co.jp/trends/?geo=JP</a><br>
<br>
グラフはすべての国を対象に、過去5年間、インターネット通信事業のカテゴリーに絞って表示したものです。<br>
<br>
まずPythonですが、予想通りの人気上昇中といったところでしょうか。<br>
<img data-src="/images/trend-python.jpg" class="default lazyload" /><br>
<br>
同じスクリプト言語のPHPやRubyは下降気味です。<br>
<img data-src="/images/trend-php.jpg" class="default lazyload" /><br>
<img data-src="/images/trend-ruby.jpg" class="default lazyload" /><br>
<br>
JavaScriptは上昇しているのかなと思いましたが、平坦な結果です。これは常に安定した人気があるということなのかもしれません。<br>
<img data-src="/images/trend-javascript.jpg" class="default lazyload" /><br>
<br>
またフロントエンドのJavaScriptライブラリのReactが爆発的に人気を増やしている様子です。<br>
<img data-src="/images/trend-react.jpg" class="default lazyload" /><br>
<br>
Android開発でも使うJavaですがどんどん人気を下げています。<br>
<img data-src="/images/trend-java.jpg" class="default lazyload" /><br>
<br>
その代わりKotlinが上昇中です。<br>
<img data-src="/images/trend-kotlin.jpg" class="default lazyload" /><br>
<br>
iOS開発で使うObjective-Cですが、だんだん人気がなくなっているようです。<br>
<img data-src="/images/trend-objectivec.jpg" class="default lazyload" /><br>
<br>
その代わりSwiftに置き換わっています。<br>
<img data-src="/images/trend-swift.jpg" class="default lazyload" /><br>
<br>
<br>
<br>
<h2>最新版Pythonを使えるようにする</h2>
さて、Google先生に聞いてpyenvで最新版のpython3.xをMacにインストールしました。ですが、以前にbrewインストールしたpython2.xを参照してしまい、最新版のpythonが使えない状態でした。色々とためした結果、次のようにして解決することができました。<br>
<br>
zシェルを使っているのに、bashの設定に環境変数を書き込んでいたのが原因だったようです。<br>
ホームディレクトリに移動して<span class="codeInline">.zshrc</span>を編集してあげます。<br>
<pre class="code">
cd ~
vi .zshrc
</pre><br>
<br>
次のような記述を最下部に付け足すことで上手く動きました。<br>
<pre class="code">
export PYENV_ROOT="$HOME/.pyenv"
eval "$(pyenv init -)"
alias py='python'
</pre><br>
毎回<span class="codeInline">python hoge.py</span>と入力するのは面倒なので<span class="codeInline">py hoge.py</span>で実行できるようにエイリアスを指定しています。<br>
<br>
保存したら、zシェルの設定をリロードします。<span class="codeInline">source .zshrc</span><br>
<span class="codeInline">py -V</span>と叩いて<span class="codeInline">Python 3.7.1</span>と出力されました。これで無事、最新版のPythonが使えるようになりました。<br>
ちなみに、<span class="codeInline">printenv</span>コマンドを実行すると、設定されている全ての環境変数が確認できます。<br>
<br>
<br>
<h2>クラスの使い方</h2>
オブジェクティブなプログラミングができるように、入門としてクラスを作ることにしました。<br>
<pre class="code">
import glob
import os

class RecursiveFile():
    lineN = 0 #static変数
    def __init__(self, startDir, extension): #コンストラクタ
        self.extension = extension
        self.paths = glob.glob(startDir+"/**/*."+extension, recursive=True)

    def trace(self, callback): #第一引数にselfを指定する必要がある
        for path in self.paths:
            RecursiveFile.lineN += 1
            callback(RecursiveFile.lineN, path) #クロージャー関数をinvokeしている
    
    def __del__(self): #デストラクタ
        print("destroy")




def tester():
    #このようにクロージャーにすることで、RecursiveFileクラスを気軽に使いまわすことができる
    def callback(num, path): #クロージャー用関数
        print("{0}: {1}".format(num, path))

    abspath = os.path.dirname(os.path.abspath(__file__))
    recursive = RecursiveFile(abspath, "txt")
    recursive.trace(callback) #クロージャー

if __name__ == "__main__":
    tester()
</pre><br>
ディレクトリを再帰的に探索して、指定の拡張子ファイルを全て取得するだけの単純な処理ですが、プログラミング中にはクラス定義、コンストラクタ、デストラクタ、メソッド、スタティック変数、クロージャーを含んでいます。ここら辺が使えるようになると管理、メンテナンスがグンと楽になりそうです。<br>
<br>
それでは、詳しくプログラミングをみていきます。<br>
<pre class="code">
class RecursiveFile():
    lineN = 0
    def __init__(self, startDir, extension):
        self.extension = extension
        self.paths = glob.glob(startDir+"/**/*."+extension, recursive=True)
</pre><br>
まず<span class="codeInline">class RecursiveFile():</span>でクラスを宣言しています。<br>
次にインデントして処理を書いていきます。<br>
<span class="codeInline">lineN</span>はstaticな変数になります。型宣言などの必要がなくこのように書けば良いみたいです。<br>
<span class="codeInline">__init__</span>はコンストラクタメソッドになります。メソッドの第一引数には<span class="codeInline">self</span>を指定しなければならないようです。<span class="codeInline">self</span>の後に続いて引数書いていけば、クラスのインスタントを作るときに、<span class="codeInline">RecursiveFile(abspath, "txt")</span>のように引数を渡して初期化することができます。<br>
そして、<span class="codeInline">glob.glob(startDir+"/**/*."+extension, recursive=True)</span>の部分が、ディレクトリを再帰的に探索して、指定の拡張子ファイルを全て取得する処理になります。<span class="codeInline">glob.glob</span>はPython3.5以降で使えるようです。特定のフォルダ以降も再帰的に処理したい場合は<span class="codeInline">recursive</span>を<span class="codeInline">True</span>に設定し、<span class="codeInline">/**/</span>のように書きます。<br>
<span class="codeInline">glob.glob("./**/*.txt", recursive=True)</span>のようにたったの一行で、再帰的にファイルが取得できてしまうなら、今回のようにクラス化する必要はなかったかもしれません。それでもここでは「クラスの使い方の勉強」と思って、このまま進めていきましょう。<br>
<br>
RecursiveFileクラスの続きの処理をみていきます。<br>
<pre class="code">
    def trace(self, callback):
        for path in self.paths:
            RecursiveFile.lineN += 1
            callback(RecursiveFile.lineN, path)
    
    def __del__(self):
        print("destroy")

</pre><br>
traceメソッドは独自に実装したメソッドになります。第二引数のcallbackには関数オブジェクトが渡される設計です。<br>
実際に次のような関数を渡してあげることで、コールバックで処理を書くことができます。<br>
<pre class="code">
    def callback(num, path):
        print("{0}: {1}".format(num, path))
</pre><br>
<br>
クラスの最初の方で宣言したstaticなlineN変数は、<span class="codeInline">RecursiveFile.lineN</span>のように書くことでアクセスできます。<br>
<span class="codeInline">__del__(self)</span>というのはデストラクタです。循環参照して解放されない場合などのデバッグに使えそうです。<br>
以上で、基本的なクラス使い方がわかりました。<br>
<br>
それでは、このクラスを実際に使ってみます。<br>
<pre class="code">
def tester():
    def callback(num, path):
        print("{0}: {1}".format(num, path))

    abspath = os.path.dirname(os.path.abspath(__file__))
    recursive = RecursiveFile(abspath, "txt")
    recursive.trace(callback)

if __name__ == "__main__":
    tester()
</pre><br>
<span class="codeInline">tester()</span>メソッドを作って<span class="codeInline">if __name__ == "__main__":</span>以降で実行しています。<br>
このファイルを直接実行した場合にのみ、<span class="codeInline">if __name__ == "__main__":</span>以降がスルーします。つまり外部ファイルからimportされた場合には実行されないので、開発でのテスト処理を書くことができます。<br>
実行結果はこのようになりました。<br>
<pre class="code">
1: /somewhere/hoge.txt
2: /somewhere/dir/fuga.txt
3: /somewhere/dir/subDir/fuga2.txt
</pre><br>
<br>
以上でPython入門ができました。もしかしたら間違いや、もっと良い書き方があるかもしれませんので、各自でPythonを勉強してみてくださいね。<br>
<br>
<a target="_blank"  href="https://www.amazon.co.jp/gp/product/4774196436/ref=as_li_tl?ie=UTF8&camp=247&creative=1211&creativeASIN=4774196436&linkCode=as2&tag=101010fun-22&linkId=cac21a621d087c2ba54b230cca57db1d"><img border="0" src="//ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&MarketPlace=JP&ASIN=4774196436&ServiceVersion=20070822&ID=AsinImage&WS=1&Format=_SL250_&tag=101010fun-22" ></a><img src="//ir-jp.amazon-adsystem.com/e/ir?t=101010fun-22&l=am2&o=9&a=4774196436" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /><a target="_blank"  href="https://www.amazon.co.jp/gp/product/4797396814/ref=as_li_tl?ie=UTF8&camp=247&creative=1211&creativeASIN=4797396814&linkCode=as2&tag=101010fun-22&linkId=70d1fff022835386a88986a32c7852ea"><img border="0" src="//ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&MarketPlace=JP&ASIN=4797396814&ServiceVersion=20070822&ID=AsinImage&WS=1&Format=_SL250_&tag=101010fun-22" ></a><img src="//ir-jp.amazon-adsystem.com/e/ir?t=101010fun-22&l=am2&o=9&a=4797396814" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /><a target="_blank"  href="https://www.amazon.co.jp/gp/product/4839960240/ref=as_li_tl?ie=UTF8&camp=247&creative=1211&creativeASIN=4839960240&linkCode=as2&tag=101010fun-22&linkId=a9431092a8ccee3fb7638f1a1943f503"><img border="0" src="//ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&MarketPlace=JP&ASIN=4839960240&ServiceVersion=20070822&ID=AsinImage&WS=1&Format=_SL250_&tag=101010fun-22" ></a><img src="//ir-jp.amazon-adsystem.com/e/ir?t=101010fun-22&l=am2&o=9&a=4839960240" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /><br>

                                </p>
                                <ul class="shareList">
                                        <li class="shareList__item"><a class="shareList__link icon-twitter" href="https://twitter.com/intent/tweet?url=https://araemon.github.io/blog/.html&text=Pythonのトレンド動向とクラスの書き方"
                                                        target="_blank" title="Twitter"></a></li>
                                        <li class="shareList__item"><a class="shareList__link icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://araemon.github.io/blog/.html"
                                                        target="_blank" title="Facebook"></a></li>
                                        <li class="shareList__item"><a class="shareList__link icon-google-plus" href="https://plus.google.com/share?url=https://araemon.github.io/blog/.html"
                                                        target="_blank" title="Google+"></a></li>
                                        <li class="shareList__item"><a class="shareList__link icon-hatebu" href="http://b.hatena.ne.jp/entry/https://araemon.github.io/blog/.html"
                                                        target="_blank" title="はてなブックマーク"></a></li>
                                        <li class="shareList__item"><a class="shareList__link icon-pocket" href="http://getpocket.com/edit?url=https://araemon.github.io/blog/.html&title=Pythonのトレンド動向とクラスの書き方"
                                                        target="_blank" title="Pocket"></a></li>
                                </ul>
                        </article>
                </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/lazyload@2.0.0-beta.2/lazyload.js"></script>
        <script>
                /****************************************
                 * Lazy Load
                ***************************************/
                lazyload();

        </script>
        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-12032595-16"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-12032595-16');
</script>
</body>

</html>