<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>
Macのシェルで使えるコマンドやスクリプトを書いて覚えていこう！</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta content="Macのシェルで使えるコマンドやスクリプトを書いて覚えていこう！" property="og:title" />
<meta content="article" property="og:type" />
<meta content="https://araemon.github.io/blog/mac-shell-script-command.html" property="og:url" />
<meta content="https://araemon.github.io" property="og:image" />
<link rel="stylesheet" type="text/css" href="/css/icon.css"  />
<link rel="stylesheet" type="text/css" href="/css/main.css?1544719373"  />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-icon-144x144.jpg">
<link rel="shortcut icon" href="/images/favicon.ico">
</head>
<body>

        <div id="container">
        <div id="header" class="blog">
        <div class="layerTransparent">
                <div class="container">
                <ul class="nav">
<li><a href="/blog/">Blog</a></li>
<li><a href="/kamityping/">KamiTyping</a></li>
<li><a href="/chazuke/">Chazuke</a></li>
<li><a href="/harmonize/">Harmonize</a></li>
<li><a href="/apps/">Other Apps</a></li>
<li><a href="/about/">About</a></li>
</ul>
<div class="copyright">Copyright © Toshihiko Arai</div>
                </div>
</div>
        </div>

<div id="contents">
<article>
    <div class="tag">
    <a href="/blog/" class="tagHighlight">Blog (記事一覧)</a>
    </div>
<h1>
Macのシェルで使えるコマンドやスクリプトを書いて覚えていこう！</h1>
<div class="time"><time pubdate="" datetime="2018-05-09">
2018-05-09</time></div>
<p>
<ul id="toc"><li><a href="#1">awk</a></li><li><a href="#2">cd</a></li><li><a href="#3">cp</a></li><li><a href="#4">curl</a></li><li><a href="#5">du</a></li><li><a href="#6">find</a></li><li><a href="#7">httpie</a></li><li><a href="#8">ln</a></li><li><a href="#9">mkdir</a></li><li><a href="#10">netstat</a></li><li><a href="#11">nkf</a></li><li><a href="#12">ps と kill</a></li><li><a href="#13">rsync</a></li><li><a href="#14">scp</a></li><li><a href="#15">stat</a></li><li><a href="#16">tail</a></li><li><a href="#17">touch</a></li><li><a href="#18">pwd</a></li><li><a href="#19">算術 $(( ～ ) )</a></li><li><a href="#20"> 比較演算子</a></li></li></ul>
このページではMacで使えそうなコマンドの覚え書きです。<br><br>内容は随時修正、変更されます。<br>アルファベット順で上げてます。<br><br><h2 id="1">awk</h2>-F'[フィールド区切り文字(複数可能)]'を指定して、文字列に対して列として処理できる。<br><br><pre class='code'>echo 1 2 3 4 |awk '{print $1}'<br>1<br><br>echo &quot;2018.05.16,something&quot; |awk  -F'[,]' '{print $2}'<br>something<br></pre><br><h2 id="2">cd</h2>(change directoryの略)<br>current directoryとごっちゃにしてたorz<br><br>参考:<br><a href="https://qiita.com/ryouzi/items/f9dee1540a04a0bfb9a3">https://qiita.com/ryouzi/items/f9dee1540a04a0bfb9a3</a><br><br><br><h2 id="3">cp</h2>ファイルやディレクトリーをコピー<br><br>-f	コピー先に同じ名前のファイルがあっても警告なしで上書きをする。<br>-r	ディレクトリごとコピーする（再帰的）<br><br><span class="backSlash">cp -rf file dir</span><br><br><br><h2 id="4">curl</h2>>1.1 What is cURL?<br>><br>>cURL is the name of the project. The name is a play on 'Client for URLs', originally with URL spelled in uppercase to make it obvious it deals with URLs. The fact it can also be pronounced 'see URL' also helped, it works as an abbreviation for "Client URL Request Library" or why not the recursive version: "Curl URL Request Library".<br><br><a href="https://curl.haxx.se/docs/faq.html#What_is_cURL">https://curl.haxx.se/docs/faq.html#What_is_cURL</a><br>より<br><br>HTTPだけでなく色々なプロトコルのリクエストを送れる。<br><br>オプション  | 意味<br>-I          | Response Header を取得して出力する<br>-i          | Response Header & Bodyを出力する<br>-v          | curlでリクエストした時のHeaderも出力する<br>-o          | ファイルに出力  <br>-X POST     |  --dataにパラメーターを記述、URLエンコードしたければ--data-urlencode<br>-F          |  ファイルをUploadするPOST<br>-u          |  ベーシック認証（ID:Password）<br>-c          |  レスポンスのCookieをcookie.txtに保存<br>-b          |  cookie.txtの中身をリクエストのCookieに含める<br>-k          | SSL証明書を無視する  <br>-x          |  Proxyを指定する<br>-H          | Request Headerを追加する<br>-L          |  リダイレクト先までアクセスする<br>-A          |  User-Agentを偽装する<br><br>参考:<br><a href="https://qiita.com/yasuhiroki/items/a569d3371a66e365316f">https://qiita.com/yasuhiroki/items/a569d3371a66e365316f</a><br><br><br><h2 id="5">du</h2>Disk Usage - report the amount of disk space used by the specified files and for each subdirectory.<br>出力される数字は容量[GB]で表す。<br><br><pre class='code'>sudo du -g -x -d 5 / | awk '$1 &gt;= 5{print}'<br>.........<br>42	/Users/Hoge/Library/Developer/Xcode<br>13	/Users/Hoge/Library/Developer/CoreSimulator<br>55	/Users/Hoge/Library/Developer<br>12	/Users/Hoge/Library/Android/sdk<br>12	/Users/Hoge/Library/Android<br>74	/Users/Hoge/Library<br>........<br></pre><br>参考:<br><a href="https://discussionsjapan.apple.com/docs/DOC-1081">https://discussionsjapan.apple.com/docs/DOC-1081</a><br><a href="https://qiita.com/hirayaCM/items/14dc021d4b27bdbfbb3d">https://qiita.com/hirayaCM/items/14dc021d4b27bdbfbb3d</a><br><br><br><h2 id="6">find</h2><br><span class="backSlash">find <Path> -name '.DS_Store' -delete -print</span><br><br>参考:<br><a href="https://qiita.com/nao_ipub/items/46be0e4c90ac55c28002">https://qiita.com/nao_ipub/items/46be0e4c90ac55c28002</a><br><br><br><h2 id="7">httpie</h2>HTTPie: a CLI, cURL-like tool for humans<br><br>cURLよりも直感的に分かりやすいHttpクライアント。<br>ハイライトしてくれるし最高かもしれない。<br><br>brewでインストール<br><br><span class="backSlash">brew install httpie</span><br><br>GitHub:<br><a href="https://github.com/jakubroztocil/httpie">https://github.com/jakubroztocil/httpie</a><br><br><br><h2 id="8">ln</h2>(linkの略)<br><br>-s オプションでシンボリックリンク(エイリアス)作成<br><br><span class="backSlash">ln -s SOURCE TARGET</span><br><br><br><h2 id="9">mkdir</h2>-pオプションをつければディレクトリが存在しない時だけディレクトリを作成できる。<br><br><span class="backSlash">mkdir -p hogehoge</span><br><br><br><h2 id="10">netstat</h2>空いているポートを確認する<br><br><span class="backSlash">netstat -an |grep LISTEN</span><br><br><br><h2 id="11">nkf</h2>Network Kanji Filterの略<br><br>文字コードのチェック<br><br><span class="backSlash">nkf -g hoge.txt</span><br><br>ファイルの文字コードをUTF-8に変換して上書き保存する<br><br><span class="backSlash">nkf -w --overwrite hoge.txt</span><br><br><br><h2 id="12">ps と kill</h2><pre class='code'>ps ax | grep ruby<br><br>5674   ??  S      0:00.56 ruby /Users/Hoge/websocket_ruby/server.rb<br>5793 s000  R+     0:00.00 grep ruby<br><br>kill -9 5674<br></pre><br><h2 id="13">rsync</h2>以前はホームページをアップロードするときにscpで丸ごとアップロードしていた。<br>このままだと、ファイル 数が増えたときに詰むので更新日時を参照してアップロードの振り分けをプログラムしようかと思っていたがrsyncで一発解決した。<br><span class="backSlash">rsync -avu works username@hoge.com:/home/username/</span><br><br>rsyncって設定が大変そうだなと思っていたが全く簡単だった。<br>たったの一行でリモートサーバー上のファイル群との差分を確認して必要な分だけアップロードしてくれる。<br>当然更新が少なければ一瞬でアップロードは完了する。<br>rsyncはMacに標準で付いているので難しい設定など必要はない。<br><br>rsyncに感動と感謝😭<br>rsyncに関して新たに記事を書いた。<br><a href="http://works.kamityping.com/post/2018/rsync-ja.html">http://works.kamityping.com/post/2018/rsync-ja.html</a><br><br>参考:<br><a href="https://qiita.com/BlueEventHorizon/items/209af1c9beaff669cd68">https://qiita.com/BlueEventHorizon/items/209af1c9beaff669cd68</a><br><br><br><h2 id="14">scp</h2>アップロード<br><span class="backSlash">scp -r works username@hoge.com:/home/username/</span><br><br>ダウンロード<br><span class="backSlash">scp -r username@hoge.com:/home/something ./</span><br><br>-rオプションをつけることでディレクトリを再帰的に読み込んでくれる。<br>FTPサーバーなど立てる必要がないので重宝する。<br><br><br><h2 id="15">stat</h2>lsコマンドよりファイルの詳細が見れる<br>-xオプションをつけると見やすく表示してくれる。<br><br><pre class='code'>stat -x hoge.txt<br>  File: &quot;hoge.txt&quot;<br>  Size: 0            FileType: Regular File<br>  Mode: (0644/-rw-r--r--)         Uid: (  501/UserName)  Gid: (   20/   staff)<br>Device: 1,4   Inode: 8593318494    Links: 1<br>Access: Thu Jan  1 00:00:00 1981<br>Modify: Thu Jan  1 00:00:00 1981<br>Change: Sun May 13 12:05:08 2018<br></pre>touchコマンドでタイムスタンプを偽装したhoge.txtを調べてみるとChange timeだけが現在の値になっていた。この値は一筋縄では変更できないようだ。<br>touchコマンドで偽装したからといってドヤ顔 :sunglasses: にならないように気をつけよう。:smile:<br><br><pre class='code'>stat -f &quot;%n %Sm&quot; -t &quot;%Y%m%dT%H%M%S&quot; *<br>20180512T134423<br></pre><br>参考:<br><a href="https://freebsd.g.hatena.ne.jp/py4s-tnk/20090202/1233581679">https://freebsd.g.hatena.ne.jp/py4s-tnk/20090202/1233581679</a><br><a href="http://x68000.q-e-d.net/~68user/unix/pickup?%A5%BF%A5%A4%A5%E0%A5%B9%A5%BF%A5%F3%A5%D7">http://x68000.q-e-d.net/~68user/unix/pickup?%A5%BF%A5%A4%A5%E0%A5%B...</a><br><br>調べているとMacのstatではオプションなどの記述が異なるようなので注意が必要だ。<br><a href="https://developer.apple.com/legacy/library/documentation/Darwin/Reference/ManPages/man1/stat.1.html">https://developer.apple.com/legacy/library/documentation/Darwin/Ref...</a><br>より<br>> **a, m, c, B**<br>><br>>    The time file was last accessed or modified, of when the inode was last changed, or the                     birth time of the inode.<br>><br><br>1時間前の.mdファイルをフィルタリングするスクリプト作ってみた。MarkDownからHtmlへ変換するpandoc処理を一部に限定する事ができるようになる。<br><pre class='code'>nowTime=`date +%s`<br>agoTime=$((nowTime-3600))<br><br>for file_path in *.md; do<br>  modifyTime=`stat -f &quot;%m&quot; $file_path`<br>  if [ $modifyTime -gt $agoTime ]; then<br>        echo $file_path<br>  fi<br>done<br></pre><br><br><h2 id="16">tail</h2>ファイルの末尾から -n オプションで行数を指定して標準出力できる。<br>下記はApacheのエラーログ最新50件を出力する。<br><br><span class="backSlash">tail -n 50 /etc/httpd/logs/error_log</span><br><br><br><h2 id="17">touch</h2>空ファイルを新規作成<br><br><span class="backSlash">touch some.txt</span><br><br><br>-tオプションでタイムスタンプを変更してファイルを作成できる。<br>生まれる前の日付でファイルを作るなんてこともできちゃう。😲<br><br><span class="backSlash">touch -t 198110081000 hoge.txt</span><br><br><br><h2 id="18">pwd</h2>(print working directoryの略)<br>現在のディレクトリパスを表示<br><br><span class="backSlash">echo `pwd`</span><br><br><br><h2 id="19">算術 $(( ～ ) )</h2>算術式展開 (arithmetic expansion)<br><br><pre class='code'>#1時間前の秒数を計算<br>nowDate=`date +%s`<br>echo $nowDate<br>echo $((nowDate-3600))<br></pre><br>参考:<br><a href="https://qiita.com/akinomyoga/items/9761031c551d43307374">https://qiita.com/akinomyoga/items/9761031c551d43307374</a><br><br><br><br><h2 id="20"> 比較演算子</h2><pre class='code'>if [ $A = $B ]; then<br># A equal B<br>fi<br><br>if [ $A -gt $B ] ; then<br># A greater than B<br>fi<br><br>if [ $A -lt $B ] ; then<br># A less than B<br>fi<br><br>if [ $A -ge $B ] ; then<br># A greater than or equal B<br>fi<br><br>if [ $A -le $B ] ; then<br># A less than or equal B<br>fi<br></pre><br><pre class='code'>if [ -f ${file} ]; then<br># file existed<br>fi<br><br>if [ -z ${A} ]; then<br># A is unset or set to the empty string (&quot;&quot;).<br>fi<br></pre><br>参考:<br><a href="https://qiita.com/toshihirock/items/461da0f60f975f6acb10">https://qiita.com/toshihirock/items/461da0f60f975f6acb10</a><br><a href="https://serverfault.com/questions/7503/how-to-determine-if-a-bash-variable-is-empty?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa">https://serverfault.com/questions/7503/how-to-determine-if-a-bash-v...</a><br><br><div class="amazon-item"><a href="https://www.amazon.co.jp/exec/obidos/ASIN/4797377623/101010fun-22/" target="_blank"><img src="http://images-jp.amazon.com/images/P/4797377623.09.LZZZZZZZ.jpg" width="250px" /></a><a href="https://www.amazon.co.jp/exec/obidos/ASIN/4797377623/101010fun-22/" class="button" target="_blank">Amazonで購入する</a></div></p>
        <ul class="shareList">
        <li class="shareList__item"><a class="shareList__link icon-twitter" href="https://twitter.com/intent/tweet?url=https://araemon.github.io/blog/mac-shell-script-command.html&text=Mac%E3%81%AE%E3%82%B7%E3%82%A7%E3%83%AB%E3%81%A7%E4%BD%BF%E3%81%88%E3%82%8B%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%84%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E8%A6%9A%E3%81%88%E3%81%A6%E3%81%84%E3%81%93%E3%81%86%EF%BC%81" target="_blank" title="Twitter"></a></li>
        <li class="shareList__item"><a class="shareList__link icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://araemon.github.io/blog/mac-shell-script-command.html" target="_blank" title="Facebook"></a></li>
        <li class="shareList__item"><a class="shareList__link icon-google-plus" href="https://plus.google.com/share?url=https://araemon.github.io/blog/mac-shell-script-command.html" target="_blank" title="Google+"></a></li>
        <li class="shareList__item"><a class="shareList__link icon-hatebu" href="http://b.hatena.ne.jp/entry/https://araemon.github.io/blog/mac-shell-script-command.html" target="_blank" title="はてなブックマーク"></a></li>
        <li class="shareList__item"><a class="shareList__link icon-pocket" href="http://getpocket.com/edit?url=https://araemon.github.io/blog/mac-shell-script-command.html&title=Mac%E3%81%AE%E3%82%B7%E3%82%A7%E3%83%AB%E3%81%A7%E4%BD%BF%E3%81%88%E3%82%8B%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%84%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E8%A6%9A%E3%81%88%E3%81%A6%E3%81%84%E3%81%93%E3%81%86%EF%BC%81" target="_blank" title="Pocket"></a></li>
        </ul>
</article>
</div>
            </div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-12032595-16"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12032595-16');
</script>

</body>
</html>